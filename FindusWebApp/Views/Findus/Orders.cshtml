@model FindusWebApp.Models.OrderViewModel

@{
    var OrderSelect = @Model != null ? @Model.OrderSelect : null;
}

<div class="form-group">
    <div class="center-block">
        <partial name="Partial/DateRangePicker" />
    </div>

    @if (OrderSelect != null)
    {
        <table class="Grid" cellpadding="0" cellspacing="0">
            <tr>
                <th></th>
                <th scope="col">Order</th>
                <th scope="col">Select</th>
            </tr>
            @foreach (var order in Model.OrderSelect)
            {
                var invoice = @Model.GetInvoice(order.Value);
                string error = @Model.GetError(order.Value);

                <tr>
                    <td style="width: 40px">
                        <img src="~/images/plus.png" id="@order.Value" style="width: 100%"/>
                    </td>

                    <td>
                        @Html.ActionLink(order.Text,"Verification", "Findus", new {orderId = order.Value})
                        <div class="text-danger">@Html.Raw(System.Web.HttpUtility.HtmlEncode(error))</div>
                    </td>
                    <td><input type='checkbox' value='false' /></td>
                </tr>
                <tr>
                    <td></td>
                    @if (invoice != null)
                    {
                        <td colspan="999">
                            <div style="display:none" id="inv-@order.Value">
                                @Html.Partial("Partial/InvoiceAccrual", invoice)
                            </div>
                        </td>
                    }
                </tr>
            }
        </table>
    }
</div>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function () {

        $('tr:has("td:empty")').hide();

        $("body").on("click", "img[src*='plus.png']", function () {
            var orderId = $(this).attr("id");
            var div = document.getElementById("inv-" + orderId);
            div.style.display = "block"

            $(this).closest("tr").next().show();
            $(this).attr("src", "/images/minus.png")
        });
        $("body").on("click", "img[src*='minus.png']", function () {
            var orderId = $(this).attr("id");
            var div = document.getElementById("inv-" + orderId);
            div.style.display = "none"
            $(this).closest("tr").next().hide();
            $(this).attr("src", "/images/plus.png")
        });
    });
</script>